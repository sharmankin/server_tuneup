#!/usr/bin/env bash



workdir=$(dirname "$0")

export PATH="${PATH}:${workdir}"

cd "${workdir}" || exit

version="$1"

[[ -z ${version}  ]] && exit 2

keypath="/usr/share/keyrings/pgdg-${version}.gpg"

release=$(lsb_release -cs)

if [[ ! -f ${keypath} ]]
  then
    curl -fsSL https://download.webmin.com/jcameron-key.asc | sudo gpg --dearmor -o "${keypath}"
    sudo tee /etc/apt/sources.list.d/pgdg-"${version}".list <<EOF
deb [signed-by=${keypath} http://apt.postgresql.org/pub/repos/apt ${release}-pgdg main
EOF
fi

../../update
../../install postgresql-"${version}" postgresql-client-"${version}" libpq-dev postgresql-"${version}"-mysql-fdw
